<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registration Page</title>
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<style> 

/* Custom styles */
.container {
	background-color: lightBlue;
	background-image: url("/image/vb.jpg");
	background-repeat: no-repeat;
	background-size: cover;
	background-position: center;
	height: 550px;
	padding-top: 10px;
}

.form-container {
	max-width: 500px;
	margin: 0 auto;
	padding: 20px;
	background-color: #fff;
	margin-top: 4px;
	border-radius: 10px;
	margin-left: 140px;
	border:2px solid black;
}
body {
	padding-top: 70px; /* Adjust for fixed navbar height */
}

.navbar {
	background-color: #e31e26; /* IRCTC Red */
	color: white; 
}

.navbar-nav .nav-link {
	color: white;
}

.redirect-links {
	position: absolute;
	top: 10px;
	right: 10px;
}
</style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
	
			<a class="navbar-brand">IRCTC</a>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav ml-auto">
					<!-- Redirected links -->
					<li class="nav-item redirect-links">
						<ul class="navbar-nav">
							<li class="nav-item"><a class="nav-link" th:href="@{/}">Home</a>
							</li>
							<li class="nav-item"><a class="nav-link"
								th:href="@{/user/login}">Login</a></li>
							<li class="nav-item"><a class="nav-link"
								th:href="@{/user/login}">Contact</a></li>
						</ul>
					</li>
				</ul>
			</div>
		
	</nav>

	<div class="container">
		<div class="form-container">
			<h2 class="text-center mb-4">Create IRCTC Account</h2>
             <form name="registrationForm" id="registrationForm"
				th:action="@{/user/create}" th:object="${user}" method="POST">
				<div class="form-group">
                   <input type="text" th:field="*{firstName}" class="form-control"
						placeholder="First Name" id="firstName"  th:classappend="${#fields.hasErrors('firstName') ?'is-invalid':''}" > <small
						style="color: #dc3545; font-size: 10px;"></small>
						<div id="validationServer03Feedback"  class="invalid-feedback"  th:each="e: ${#fields.errors('firstName')}" th:text="${e}" >
                 </div>

				</div>
				<div class="form-group">
					<input type="text" th:field="*{lastName}" class="form-control"
						placeholder="Last Name" id="lastName"  th:classappend="${#fields.hasErrors('lastName') ?'is-invalid':''}"> <small
						style="color: #dc3545; font-size: 10px"></small>
						<div id="validationServer03Feedback"  class="invalid-feedback"  th:each="e: ${#fields.errors('lastName')}" th:text="${e}" >
                 </div>
				</div>
				<div class="form-group">
					<input type="tel" th:field="*{contact}" class="form-control"
						placeholder="Phone" id="phone"  th:classappend="${#fields.hasErrors('contact') ?'is-invalid':''}" > <small
						style="color: #dc3545; font-size: 10px;"></small>
						<div id="validationServer03Feedback"  class="invalid-feedback"  th:each="e: ${#fields.errors('contact')}" th:text="${e}" >
                 </div>
				</div>
				<div class="form-group">
					<input type="text" th:field="*{email}" class="form-control"
						placeholder="Email" id="email"  th:classappend="${#fields.hasErrors('email') ?'is-invalid':''}"> <small
						style="color: #dc3545; font-size: 10px;"></small>
						<div id="validationServer03Feedback"  class="invalid-feedback"  th:each="e: ${#fields.errors('email')}" th:text="${e}" >
                 </div>
				</div>
				<div class="form-group">
					<input type="password" th:field="*{password}" class="form-control"
						placeholder="Password" id="password" th:classappend="${#fields.hasErrors('password') ?'is-invalid':''}"> <small
						style="color: #dc3545; font-size: 10px;"></small>
						<div id="validationServer03Feedback"  class="invalid-feedback"  th:each="e: ${#fields.errors('Password')}" th:text="${e}" >
                 </div>
						
						
						
						
				</div>
				<div class="form-group">
					<input type="password" class="form-control"
						placeholder="Confirm Password" id="confirmPassword"> <small
						style="color: #dc3545; font-size: 10px;"></small>
              </div>
				<div class="form-group" id="userType">
				
					<div class="form-check form-check-inline">
						<input class="form-check-input" type="radio" th:field="*{role}"
							th:value="user" name="userType" id="user" value="user"  th:classappend="${#fields.hasErrors('role') ?'is-invalid':''}">
						<label class="form-check-label" for="user">User</label>
						
						<br>
							<div id="validationServer03Feedback"  class="invalid-feedback"  th:each="e: ${#fields.errors('role')}" th:text="${e}" >
                 </div>
					</div>
					<div class="form-check form-check-inline">
						<input class="form-check-input" type="radio" th:field="*{role}"
							th:value="admin" name="userType" id="admin" value="admin"  th:classappend="${#fields.hasErrors('role') ?'is-invalid':''}">
						<label class="form-check-label" for="admin">Admin</label>
						<br>
							<div id="validationServer03Feedback"  class="invalid-feedback"  th:each="e: ${#fields.errors('role')}" th:text="${e}" >
                 </div>
					</div>
					<small
						style="color: #dc3545; font-size: 10px;"></small>
					</div>
				<button type="submit" class="btn btn-primary btn-block" 
				style="background-color:#E31E26">Submit</button>
			</form>
		</div>
	</div>

	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
	<script
		src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

	<script>
	
	function showError(input, errMessage){
	    const parentElement = input.parentElement;
	    const small = parentElement.querySelector('small');
	    small.innerHTML = errMessage;
	    input.classList.add("is-invalid");
	    event.preventDefault();
	  }
	
	  function removeError(input){
		    const formControl = input.parentElement;
		    const small = formControl.querySelector('small');
		    small.innerHTML = "";
		    input.classList.remove("is-invalid");
		  }
	  function radioError(input){
		 
		    const small = input.querySelector('small');
		    small.innerHTML = "";
		    input.classList.remove("is-invalid");
		  }
	  function removeAllError(firstName, lastName, phone, email, password, confirmPassword,userType){
		  removeError(firstName);
		  removeError(lastName);
		  removeError(phone);
		  removeError(email);
		  removeError(password);
		  removeError(confirmPassword);
		  removeError(userType);
	  }
	
    function formFeldValidation(){
            var firstName = document.getElementById("firstName");
            var lastName = document.getElementById("lastName");
            var phone = document.getElementById("phone");
            var email = document.getElementById("email");
            var password = document.getElementById("password");
            var confirmPassword = document.getElementById("confirmPassword");
            var userType = document.getElementById("userType");

            var isValid = true;
            
            removeAllError(firstName, lastName, phone, email, password, confirmPassword,userType);

            if (firstName.value.trim() === ""){
            	showError(firstName, "*First Name should not be blank");
      	        isValid = false;
      	        }

            else if (lastName.value.trim() === ""){
            	showError(lastName, "*Last Name should not be blank");
      	        isValid = false;
      	        }
            	

            else if (phone.value.trim() === ""){
            	showError(phone, "*Contact should not be blank");
      	        isValid = false;
      	        }
            	

            else if (email.value.trim() === ""){
            	showError(email, "*Email should not be blank");
      	        isValid = false;
      	        }
            	

            else if (password.value.trim() === ""){
            	showError(password, "*password should not be blank");
      	        isValid = false;
      	        }
            	

            else if(confirmPassword.value.trim() === ""){
            	showError(confirmPassword, "*confirm password should not be blank");
      	        isValid = false;
      	        } 
            else if(userType.value.trim() === ""){
            	radioError(userType, "*select a userType");
      	        isValid = false;
      	        } 
            	

            event.preventDefault();
            return isValid;
    };

    // Validate passwords match
     function isPasswordMatch(){
        if(formFieldValidation()){
            var password = document.getElementById("password").value;
            var confirmPassword = document.getElementById("confirmPassword").value;
            var isValid = true;

            if (password !== confirmPassword) {
                alert("Passwords do not match");
                event.preventDefault();
                isValid = false;
            }
        }
        return isValid;
    };

    // Validate phone number format
    function validatePhoneNumber(phoneNumber) {
      // Regular expression for a 10-digit phone number
      var phonePattern = /^\d{10}$/;
      return phonePattern.test(phoneNumber);
    }

    document.getElementById("registrationForm").addEventListener("submit", function(event) {
    	
        if(isPasswordMatch()){
            var phoneNumber = document.getElementById("phone").value;
            if (!validatePhoneNumber(phoneNumber)) {
                alert("Please enter a valid 10-digit phone number");
                event.preventDefault();
            }
        }
    });
</script>

</body>
</html>
